{"version":3,"sources":["redux/actions.js","redux/actionTypes.js","components/Canvas.js","constants.js","render.js","App.js","redux/opReducer.js","redux/store.js","index.js"],"names":["opSetType","type","payload","connect","state","history","dispatch","strokeStyle","useState","mouseDown","setState","handleEventAs","event","x","y","opCreate","pageX","refCanvas","current","offsetLeft","pageY","offsetTop","Error","handleEvent","useRef","useEffect","width","parseInt","getComputedStyle","parentNode","getPropertyValue","height","resize","ctx","getContext","op","x1","y1","fillStyle","slice","reverse","x2","y2","beginPath","fillRect","stroke","moveTo","lineTo","render","ref","onMouseUp","onMouseMove","onMouseDown","useStyles","makeStyles","theme","title","flexGrow","menuButton","marginRight","spacing","content","overflow","container","paddingTop","paddingBottom","canvas","future","classes","AppBar","position","Toolbar","Typography","variant","className","Button","color","onClick","disabled","length","Container","Card","raised","reduce","action","concat","last","rest","store","configureStore","reducer","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.acbc6b0c.chunk.js","sourcesContent":["import { OP_CREATE, OP_UPDATE, UNDO, REDO, OP_SET_TYPE } from \"./actionTypes\";\n\nexport const opSetType = (type) => ({\n  type: OP_SET_TYPE,\n  payload: { type },\n});\n\nexport const opCreate = (type, strokeStyle, x, y) => ({\n  type: OP_CREATE,\n  payload: { type, strokeStyle, x, y },\n});\n\nexport const opUpdate = (x, y) => ({\n  type: OP_UPDATE,\n  payload: { x, y },\n});\n\nexport const undo = () => ({\n  type: UNDO,\n  payload: {},\n});\n\nexport const redo = () => ({\n  type: REDO,\n  payload: {},\n});\n","export const OP_SET_TYPE = \"op/opSetType\";\nexport const OP_CREATE = \"op/create\";\nexport const OP_UPDATE = \"op/update\";\nexport const UNDO = \"undo\";\nexport const REDO = \"redo\";\n","import React, { useEffect, useState, useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { opCreate, opUpdate } from \"./../redux/actions\";\nimport { render } from \"./../render\";\nimport { OP_TYPE_RECT, OP_TYPE_GESTURE } from \"./../constants\";\n\nfunction resize(refCanvas) {\n  refCanvas.current.width = parseInt(\n    getComputedStyle(refCanvas.current.parentNode).getPropertyValue(\"width\")\n  );\n  refCanvas.current.height = parseInt(\n    getComputedStyle(refCanvas.current.parentNode).getPropertyValue(\"height\")\n  );\n}\n\nfunction Canvas({ history, dispatch, type, strokeStyle }) {\n  const [state, setState] = useState({ mouseDown: false }),\n    handleEventAs = (type, strokeStyle, event) => {\n      switch (event.type) {\n        case \"mousedown\":\n          setState({ mouseDown: true });\n\n          return dispatch(\n            opCreate(\n              type,\n              strokeStyle,\n              event.pageX - refCanvas.current.offsetLeft,\n              event.pageY - refCanvas.current.offsetTop\n            )\n          );\n        case \"mousemove\":\n          if (state.mouseDown) {\n            return dispatch(\n              opUpdate(\n                event.pageX - refCanvas.current.offsetLeft,\n                event.pageY - refCanvas.current.offsetTop\n              )\n            );\n          }\n          return;\n        case \"mouseup\":\n          return setState({ mouseDown: false });\n        default:\n          throw new Error(\"unknown event.type: \", event.type);\n      }\n    },\n    handleEvent = (event) => {\n      switch (type) {\n        case OP_TYPE_GESTURE:\n          return handleEventAs(type, strokeStyle, event);\n        case OP_TYPE_RECT:\n          return handleEventAs(type, strokeStyle, event);\n        default:\n          throw new Error(\"unknown op.type: \", type);\n      }\n    };\n\n  let refCanvas = useRef(null);\n\n  useEffect(() => {\n    resize(refCanvas);\n  });\n\n  useEffect(() => {\n    render(refCanvas, history);\n  });\n\n  return (\n    <canvas\n      ref={refCanvas}\n      onMouseUp={handleEvent}\n      onMouseMove={handleEvent}\n      onMouseDown={handleEvent}\n    ></canvas>\n  );\n}\n\nconst mapStateToProps = (state) => state;\n\nexport default connect(mapStateToProps, null)(Canvas);\n","export const OP_TYPE_GESTURE = \"gesture\";\nexport const OP_TYPE_RECT = \"rect\";\nexport const OP_TYPE_DEFAULT = OP_TYPE_GESTURE;\nexport const OP_STROKE_STYLE_DEFAULT = \"#333\";\n","import { OP_TYPE_RECT, OP_TYPE_GESTURE } from \"./constants\";\n\nexport const render = (refCanvas, history) => {\n  // eslint-disable-next-line\n  refCanvas.current.width = refCanvas.current.width;\n\n  const ctx = refCanvas.current.getContext(\"2d\");\n\n  for (const op of history) {\n    const { type, strokeStyle, x: x1, y: y1 } = op[0];\n\n    ctx.strokeStyle = strokeStyle;\n    ctx.fillStyle = strokeStyle;\n\n    switch (type) {\n      case OP_TYPE_RECT:\n        // eslint-disable-next-line\n        const [{ x: x2, y: y2 }, ...rest] = op.slice().reverse();\n        ctx.beginPath();\n        ctx.fillRect(x1, y1, (x1 - x2) * -1, (y1 - y2) * -1);\n        ctx.stroke();\n        break;\n      case OP_TYPE_GESTURE:\n        ctx.beginPath();\n        ctx.moveTo(x1, y1);\n        for (const { x: x2, y: y2 } of op) {\n          ctx.lineTo(x2, y2);\n          ctx.stroke();\n        }\n        break;\n      default:\n        throw new Error(\"unknown op: \", op);\n    }\n  }\n};\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Card from \"@material-ui/core/Card\";\nimport Container from \"@material-ui/core/Container\";\nimport Button from \"@material-ui/core/Button\";\nimport Canvas from \"./components/Canvas\";\nimport { OP_TYPE_RECT, OP_TYPE_GESTURE } from \"./constants\";\nimport { opSetType, redo, undo } from \"./redux/actions\";\n\nconst useStyles = makeStyles((theme) => ({\n  title: {\n    flexGrow: 1,\n  },\n  menuButton: {\n    marginRight: theme.spacing(2),\n  },\n  content: {\n    flexGrow: 1,\n    height: \"100vh\",\n    overflow: \"auto\",\n  },\n  container: {\n    paddingTop: theme.spacing(12),\n    paddingBottom: theme.spacing(8),\n  },\n  canvas: {\n    height: \"70vh\",\n  },\n}));\n\nfunction App({ history, future, type, dispatch }) {\n  const classes = useStyles();\n\n  return (\n    <div>\n      <AppBar position=\"relative\">\n        <Toolbar>\n          <Typography variant=\"h6\" className={classes.title}>\n            Redux Paint\n          </Typography>\n          <Button\n            variant=\"contained\"\n            color={type === OP_TYPE_GESTURE ? \"secondary\" : \"default\"}\n            className={classes.menuButton}\n            onClick={() =>\n              dispatch(opSetType(OP_TYPE_GESTURE))\n            }\n          >\n            Gesture\n          </Button>\n          <Button\n            variant=\"contained\"\n            color={type === OP_TYPE_RECT ? \"secondary\" : \"default\"}\n            className={classes.menuButton}\n            onClick={() =>\n              dispatch(opSetType(OP_TYPE_RECT))\n            }\n          >\n            Rect\n          </Button>\n          <Button\n            variant=\"contained\"\n            className={classes.menuButton}\n            disabled={history.length === 0}\n            onClick={() => {\n              dispatch(undo());\n            }}\n          >\n            Undo\n          </Button>\n          <Button\n            variant=\"contained\"\n            className={classes.menuButton}\n            disabled={future.length === 0}\n            onClick={() => {\n              dispatch(redo());\n            }}\n          >\n            Redo\n          </Button>\n        </Toolbar>\n      </AppBar>\n      <main className={classes.content}>\n        <Container className={classes.container}>\n          <Card className={classes.canvas} raised={true}>\n            <Canvas />\n          </Card>\n        </Container>\n      </main>\n    </div>\n  );\n}\n\nconst mapStateToProps = (state) => state;\n\nexport default connect(mapStateToProps, null)(App);\n","import { OP_CREATE, OP_UPDATE, UNDO, REDO, OP_SET_TYPE } from \"./actionTypes\";\nimport { OP_TYPE_DEFAULT, OP_STROKE_STYLE_DEFAULT } from \"./../constants\";\n\nfunction reduce(\n  state = {\n    type: OP_TYPE_DEFAULT,\n    strokeStyle: OP_STROKE_STYLE_DEFAULT,\n    history: [],\n    future: [],\n  },\n  action\n) {\n  switch (action.type) {\n    case OP_SET_TYPE:\n      return {\n        ...state,\n        type: action.payload.type,\n      };\n    case OP_CREATE:\n      return {\n        ...state,\n        future: [],\n        history: state.history.concat([[action.payload]]),\n      };\n    case OP_UPDATE:\n      var [last, ...rest] = state.history.slice().reverse();\n      return {\n        ...state,\n        future: [],\n        history: [...rest.slice().reverse(), last.concat([action.payload])],\n      };\n    case UNDO:\n      return {\n        ...state,\n        future: state.future.concat(state.history.slice(-1)),\n        history: state.history.slice(0, -1),\n      };\n    case REDO:\n      return {\n        ...state,\n        future: state.future.slice(0, -1),\n        history: state.history.slice().concat(state.future.slice(-1)),\n      };\n    default:\n      return state;\n  }\n}\n\nexport default reduce;\n","import { configureStore } from \"@reduxjs/toolkit\";\nimport reduce from \"./opReducer\";\n\nconst store = configureStore({ reducer: reduce });\n\n// store.subscribe(() => console.log(store.getState()));\n\nexport default store;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport { Provider } from \"react-redux\";\nimport store from \"./redux/store\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}